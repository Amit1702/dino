<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title> Dino game</title>
<style>
body{
  margin:0;
  overflow:hidden;
  font-family:Arial;
  background:#f7f7f7;
}
canvas{
  display:block;
}
#restartBtn{
  position:absolute;
  top:120px;
  left:50%;
  transform:translateX(-50%);
  padding:10px 20px;
  font-size:16px;
  display:none;
  cursor:pointer;
}
</style>
</head>
<body>

<canvas id="game"></canvas>
<button id="restartBtn">Restart</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const restartBtn = document.getElementById("restartBtn");

canvas.width = window.innerWidth;
canvas.height = 300;

let groundY = 250;
let gravity = 0.8;
let score = 0;
let gameOver = false;

/* Dino */
let dino = {
  x:50,
  y:groundY-40,
  width:40,
  height:40,
  dy:0,
  jump:false
};

/* Obstacles */
let obstacles = [];
let obstacleTimer = 0;

/* Clouds */
let clouds = [];
for(let i=0;i<5;i++){
  clouds.push({
    x:Math.random()*canvas.width,
    y:Math.random()*100+20,
    width:60,
    height:20
  });
}

/* Stars */
let stars = [];
for(let i=0;i<60;i++){
  stars.push({
    x:Math.random()*canvas.width,
    y:Math.random()*150,
    size:Math.random()*2
  });
}

/* Time Cycle */
let cycleStart = Date.now();
let sunX = -100;
let moonX = -100;

function getTimePhase(){
  let elapsed = (Date.now()-cycleStart)/1000;
  let total = 103; // 40+18+30+15
  let t = elapsed % total;

  if(t < 40) return "day";
  if(t < 58) return "evening";
  if(t < 88) return "night";
  return "morning";
}

/* Jump */
document.addEventListener("keydown", e=>{
  if(e.code==="Space" && !dino.jump && !gameOver){
    dino.dy=-15;
    dino.jump=true;
  }
});

/* Restart */
restartBtn.onclick=function(){
  obstacles=[];
  score=0;
  gameOver=false;
  dino.y=groundY-40;
  restartBtn.style.display="none";
};

/* Update */
function update(){

if(gameOver) return;

dino.y+=dino.dy;
dino.dy+=gravity;

if(dino.y>=groundY-40){
  dino.y=groundY-40;
  dino.jump=false;
}

obstacleTimer++;
if(obstacleTimer>100){
  let type = Math.random()>0.5?"cactus":"crow";
  obstacles.push({
    x:canvas.width,
    type:type,
    width: type==="cactus"?20:30,
    height:type==="cactus"?40:20,
    y:type==="cactus"?groundY-40:groundY-100
  });
  obstacleTimer=0;
}

obstacles.forEach(o=>{
  o.x-=6;
});

obstacles=obstacles.filter(o=>o.x+o.width>0);

obstacles.forEach(o=>{
  if(dino.x<o.x+o.width &&
     dino.x+dino.width>o.x &&
     dino.y<o.y+o.height &&
     dino.y+dino.height>o.y){
       gameOver=true;
       restartBtn.style.display="block";
     }
});

clouds.forEach(c=>{
  c.x-=1;
  if(c.x+c.width<0){
    c.x=canvas.width;
  }
});

score+=0.05;

moveSunMoon();
}

function moveSunMoon(){
let phase=getTimePhase();

if(phase==="day"||phase==="evening"){
  sunX+=0.5;
  if(sunX>canvas.width+50) sunX=-100;
}

if(phase==="night"||phase==="morning"){
  moonX+=0.5;
  if(moonX>canvas.width+50) moonX=-100;
}
}

/* Draw */
function draw(){

let phase=getTimePhase();

if(phase==="day") canvas.style.background="#87CEEB";
if(phase==="evening") canvas.style.background="#FDB813";
if(phase==="night") canvas.style.background="#001d3d";
if(phase==="morning") canvas.style.background="#ffcc99";

ctx.clearRect(0,0,canvas.width,canvas.height);

/* Stars */
if(phase==="night"){
  ctx.fillStyle="white";
  stars.forEach(s=>{
    ctx.fillRect(s.x,s.y,s.size,s.size);
  });
}

/* Sun */
if(phase==="day"||phase==="evening"){
  ctx.fillStyle="yellow";
  ctx.beginPath();
  ctx.arc(sunX,80,30,0,Math.PI*2);
  ctx.fill();
}

/* Moon */
if(phase==="night"||phase==="morning"){
  ctx.fillStyle="white";
  ctx.beginPath();
  ctx.arc(moonX,80,25,0,Math.PI*2);
  ctx.fill();
}

/* Clouds */
ctx.fillStyle="white";
clouds.forEach(c=>{
  ctx.fillRect(c.x,c.y,c.width,c.height);
});

/* Ground */
ctx.fillStyle="#333";
ctx.fillRect(0,groundY,canvas.width,5);

/* Dino */
ctx.fillStyle="#222";
ctx.fillRect(dino.x,dino.y,dino.width,dino.height);

/* Obstacles */
if(phase==="night"){
  ctx.fillStyle="grey";
}else{
  ctx.fillStyle="green";
}

obstacles.forEach(o=>{
  ctx.fillRect(o.x,o.y,o.width,o.height);
});

/* Score */
ctx.fillStyle="black";
ctx.font="20px Arial";
ctx.fillText("Score: "+Math.floor(score),canvas.width-150,30);

if(gameOver){
  ctx.font="30px Arial";
  ctx.fillText("Game Over",canvas.width/2-80,100);
}
}

function loop(){
update();
draw();
requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>

